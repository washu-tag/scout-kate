# ZAP scan rules configuration for Scout
# Format: rule_id<TAB>FAIL|WARN|IGNORE<TAB>rule name
#
# Rules set to FAIL are findings that should be resolved by the
# global Traefik security headers middleware and Launchpad config.
# If these trigger, the fix is not working correctly.
#
# Usage:
#   zap-baseline.py -t <url> -c /zap/wrk/rules.conf -J report.json
#   zap-full-scan.py -t <url> -c /zap/wrk/rules.conf -J report.json

# --- FAIL: Should be fixed by security headers middleware ---
10035	FAIL	Strict-Transport-Security Header Not Set
10020	FAIL	Anti-clickjacking Header Missing
10038	FAIL	Content Security Policy (CSP) Header Not Set
10021	FAIL	X-Content-Type-Options Header Missing
10063	FAIL	Permissions Policy Header Not Set
# 90004 covers three Spectre isolation headers: COOP, COEP, and CORP.
# The security headers middleware sets Cross-Origin-Opener-Policy (COOP)
# but intentionally omits Cross-Origin-Resource-Policy (CORP) and
# Cross-Origin-Embedder-Policy (COEP) because setting them globally
# breaks cross-origin Keycloak OAuth flows across subdomains.
# ZAP still flags the missing CORP header under this rule, so we
# downgrade to WARN rather than FAIL.
90004	WARN	Insufficient Site Isolation Against Spectre Vulnerability
10036	FAIL	Server Leaks Version Information via "Server" HTTP Response Header Field
10037	FAIL	Server Leaks Information via "X-Powered-By" HTTP Response Header Field(s)
40025	FAIL	Proxy Disclosure

# --- IGNORE: False positives or by-design behavior ---
10202	IGNORE	Absence of Anti-CSRF Tokens
10110	IGNORE	Dangerous JS Functions
10096	IGNORE	Timestamp Disclosure

# --- WARN: Known issues in upstream apps, not directly fixable ---
90003	WARN	Sub Resource Integrity Attribute Missing
10055	WARN	CSP: Wildcard Directive
10010	WARN	Cookie No HttpOnly Flag
10011	WARN	Cookie Without Secure Flag
10054	WARN	Cookie without SameSite Attribute
43	WARN	Source Code Disclosure - File Inclusion
10051	WARN	Relative Path Confusion
10044	WARN	Big Redirect Detected (Potential Sensitive Information Leak)
